<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Detalhes do Grupo - TMA IPTV PREMIUM</title>
  <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
  <header class="header">
    <h1>TMA IPTV PREMIUM</h1>
    <nav class="nav">
      <a href="/" data-i18n="nav-home">In√≠cio</a>
      <a href="/downloads.html" data-i18n="nav-downloads">Downloads</a>
      <a href="/admin/login.html" data-i18n="nav-panel">Painel</a>
      <a href="#termos" data-i18n="nav-terms">Termos</a>
      <a href="#contato" data-i18n="nav-contact">Contato</a>
    </nav>
    <!-- Language switcher -->
    <div style="margin-top:8px; font-size:12px;">
      <button id="lang-pt" style="background:none; border:none; color:#fff; cursor:pointer;">PT</button> |
      <button id="lang-en" style="background:none; border:none; color:#fff; cursor:pointer;">EN</button>
    </div>
  </header>
  <div class="container">
    <h2 id="group-title" data-i18n="group-title">Grupo</h2>
    <div id="products"></div>
  </div>

  <!-- WhatsApp floating button -->
  <a href="https://api.whatsapp.com/send?phone=5535998993464" class="floating-button" id="whatsapp-btn" target="_blank" rel="noopener" title="Fale conosco no WhatsApp">
    <img src="img/whatsapp-icon.png" alt="WhatsApp" style="width:60%;height:60%;">
  </a>
  <!-- Chatbot floating button and widget -->
  <div class="floating-button" id="chat-toggle" style="bottom: 90px; background-color:#007bff;">
    <img src="img/chatbot.png" alt="Chatbot" style="width:60%;height:60%;">
  </div>
  <div class="chat-widget" id="chat-widget">
    <div class="chat-header">Chatbot</div>
    <div class="chat-messages" id="chat-messages"></div>
    <div class="chat-input">
      <input type="text" id="chat-input" placeholder="Digite sua mensagem...">
      <button id="chat-send">Enviar</button>
    </div>
  </div>

  <script src="/js/chat.js"></script>
  <script src="/js/lang.js"></script>
  <script src="/js/group.js"></script>
  <script>
  async function renderGrupoDetalhes() {
    // supondo que o id do grupo venha na query string ?id=XYZ
    const params = new URLSearchParams(location.search);
    const id = params.get('id');
    if (!id) return;

    const [resG, resP] = await Promise.all([
      fetch(`/api/groups/${encodeURIComponent(id)}`),
      fetch('/api/products')
    ]);
    const grupo    = await resG.json();
    const produtos = await resP.json().then(arr => arr.filter(p => p.groupId === id));

    document.getElementById('group-title').textContent = grupo.name;
    const cont = document.getElementById('products');
    cont.innerHTML = '';
    produtos.forEach(p => {
      const li = document.createElement('li');
      li.textContent = p.name;
      cont.appendChild(li);
    });
  }

  document.addEventListener('DOMContentLoaded', renderGrupoDetalhes);
  window.addEventListener('storage', e => {
    if (e.key === 'refreshMain') renderGrupoDetalhes();
  });
</script>
</body>
</html>